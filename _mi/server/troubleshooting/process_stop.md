---
title: "프로세스 중단 문제"
layout: single
sidebar:
  nav: "category-nav"
categories:
  - server
  - troubleshooting
---


서버 사용 중 프로세스가 응답하지 않거나 작업이 멈춘 경우, 대개 시스템 자원(CPU 또는 메모리)의 과부하가 주요 원인입니다

## 원인

- CPU 과부하  
  특정 프로세스 또는 다수의 병렬 프로세스가 CPU 코어를 과도하게 점유하면 전체 서버의 응답 속도가 느려지거나 정지될 수 있습니다.

- 메모리 부족  
  메모리 사용량이 시스템 전체 용량을 초과하는 경우, 프로세스가 swap 영역으로 이동하거나 강제 종료될 수 있습니다.

- 병렬 처리 수 과다  
  * MI: 현재 서버는 30개의 CPU 코어를 사용 중입니다.  
  하나의 작업 또는 다수의 작업이 병렬 구조로 30개 이상의 코어를 동시에 사용하려 할 경우, 전체 시스템이 정지할 수 있습니다.

## 진단 방법

1. CPU 사용량 확인

```bash
top
```

- 현재 실행 중인 프로세스들의 CPU 사용률을 실시간으로 확인할 수 있습니다.
- 특정 프로세스가 과도하게 CPU를 점유하는 경우, 아래 명령어로 종료할 수 있습니다.

```bash
kill [PID]
```

2. 메모리 사용량 확인

```bash
free -h
```

- 전체 메모리, 사용 중인 메모리, 사용 가능한 메모리 등을 확인할 수 있습니다.
- 사용 가능한 메모리가 거의 없다면, 해당 작업을 분할해서 실행해야 합니다.

3. 병렬 작업 수 점검
- 사용 중인 코드(R, Python 등) 내에서 병렬 파라미터 설정 확인
  - 예: `n_jobs=8`, `--threads 8`, `--cpus-per-task=8` 등

## 해결 방법

- 과도한 자원을 사용하는 프로세스를 종료하거나 병렬 처리 수를 줄여 작업을 나눠서 실행합니다.
- 대용량 데이터를 처리하는 경우, 데이터를 여러 조각으로 나누어 처리합니다.
- R, Python 등에서는 `batch 처리`, `iterator`, `generator` 등을 활용한 점진적 실행을 고려합니다.

## 추가 도구

- `htop` 명령어는 `top`보다 직관적인 인터페이스로 자원 사용 상태를 확인할 수 있습니다.
- 설치되어 있지 않다면 다음 명령어로 설치할 수 있습니다.

```bash
sudo apt-get install htop
htop
```

## 참고

- 병렬 작업은 시스템 상황에 맞게 조정하는 것이 중요합니다.
- 프로세스 중지와 관련된 시스템 로그는 `/var/log/syslog`, `dmesg` 등을 통해 추가 확인할 수 있습니다.
